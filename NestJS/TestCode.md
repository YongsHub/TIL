# TestCode

소프트웨어 개발 과정에서 코드를 작성하고 개발자가 직접 몇 개의 인풋을 넣어보면서 자기가 알맞게 코딩했는지 확인하는데, 직접 몇 개의 값만 확인해보고 넘어가는 방법은 문제가 발생할 수 있다.

- 확인해보고 싶은 값을 매 테스트마다 다시 입력해야 하는 것
- 기능이 추가될 때마다 입력해야 할 값이 점점 늘어남.
- 다른 사람이 내 모듈을 사용하거나 내 모듈을 수정할 경우 내가 고려했던 경우의 수까지 모두 테스트 해야함.

### ❗️ 따라서 테스트 코드 작성은 중요하다

테스트 코드를 작성해 두지 않으면 작성해 둔 코드들이 제대로 동작하는지 장담할 수 없고 품질에 문제를 일으킨다! Unit Test를 알아보자

## Unit Test

1. 다양한 상황에서 코드를 실행해 볼 수 있다.
2. 같은 결과물인지 확인하기 용이하므로 코드 내부를 수정하기가 쉽다.

## 👨‍💻 Nest.JS Framework에서의 유닛 테스트작성에 대해 살펴보자

```
소프트웨어를 테스팅할 때 대상의 범위나 크기에 따라 Integeration Test, End - to - End Test, Unit Test 등으로 나눌 수 있는데 이 중에서도 Unit Test는 소프트웨어를 이루고 있는 가장 작은 모듈에 대해서 테스트하는 것을 말한다. Unit Test를 작성할 때 중요한 점은 각각의 테스트가 다른 테스트의 결과에 의존하면 안된다는 것이다. 각 테스트가 독립적인 목표와 상태를 가지고 있어서 다른 테스트가 실패하든 성공하든 영향을 받지 않아야 한다. 그래야 테스트가 실패했을 때 어느 부분에서 버그가 발생한 것인지 쉽게 찾을 수 있다. 각 언어별로 유닛테스트를 자동화하거나 유닛테스트 작성을 도와주는 도구들을 적절히 활용하는 것이 좋다.
```

## 👨‍💻 Mock이란?

> 실제 객체를 만들기엔 비용과 시간이 많이 들거나 의존성이 길게 걸쳐져 있어 제대로 구현하기 어려울 경우, 가짜 객체를 만들어 사용한다.

### Mock 객체가 필요한 시기

[참고 블로그](http://www.incodom.kr/Mock)

- 테스트 작성을 위한 환경 구축이 어려운 경우

  - 환경 구축을 위한 작업 시간이 많이 필요한 경우에 Mock객체를 사용한다. (데이터베이스, 웹 서버 등)
  - 특정 모듈을 갖고 있지 않아서 테스트 환경을 구축하지 못할 때 또는 타 부서와의 협의나 정책이 필요한 경우

- 테스트가 특정 경우나 순간에 의존적인 경우

- 테스트 시간이 오래 걸리는 경우

## 민액에 실제로 동일한 환경을 구성해준다면?

> 실제 DB에 dummy 데이터가 들어가게 될 것이고, 나중에 이를 cleanup해줘야 하는 수고를 해야 합니다. 그 과정에서 DB를 망가뜨릴 수 있는 실수할 가능성도 존재함.

> 여러모로 불편한 점 때문에 typeORM에서는 테스트를 위한 mocking DB를 구성할 수 있다. DB뿐만 아니라 service또한 직접 불러오는 것이 아닌 존재하는 것처럼 작성할 수 있는데 이를 Mocking(흉내내기)라고 한다.

> 테스트하고자 하는 UserService에서 User Repo에서 사용하는 메서드는 findOne, save, create 등등이 있을 수 있는데 typeORM에서 getRepositoryToken이라는 메서드를 제공하니 이를 활용하여 작성할 수 있다.

[위 내용 참고 블로그](https://darrengwon.tistory.com/1004?category=915252)
